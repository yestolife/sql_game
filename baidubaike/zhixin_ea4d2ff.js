define("wiki-lemma:widget/lemma_content/configModule/zhixin/zhixin",function(e,i,a){var t=e("wiki-common:widget/lib/jquery/jquery"),s=e("wiki-common:widget/lib/jsmart/jsmart"),n=e("wiki-common:widget/component/nslog/nslog"),l=new s('{%foreach $dataList as $card => $list%}\n<div class="zhixin-group js-group" data-dataType="{%$dataType|f_escape_xml%}">\n<h6 class="js-cardTitle">\n<span>{%$list.tipTitle|f_escape_xml%}</span>\n</h6>\n<div class="zhixin-fixBtn js-fixBtn">\n<div class="openFix" title="若推荐内容有误，请点击纠错进行反馈">纠错</div>\n<div class="closeFix">关闭纠错</div>\n</div>\n<div class="zhixin-list">\n{%foreach $list.data as $key => $item%}\n<div class="zhixin-item" nslog="area" nslog-type="10000101" nslog-params=\'{"source":"{%$list.source|escape:js|f_escape_xml%}","url":"{%$item.url|escape:js|f_escape_xml%}","targetId":"{%$item.lemmaId|escape:js|f_escape_xml%}"}\'>\n<div class="portraitbox">\n<a href="{%$item.url|f_escape_xml%}" target="_blank">\n{%if !!$item.pic%}\n<img src="{%$item.pic|wiki_common_https_trans|f_escape_xml%}" alt="{%$item.title|f_escape_xml%}" />\n{%else%}\n<img src="https://bkssl.bdimg.com/static/wiki-lemma/widget/lemma_content/configModule/zhixin/img/cityzhixinemptyimg_eb6334f.png" alt="{%$item.title|f_escape_xml%}" />\n{%/if%}\n</a>\n</div>\n<p class="item-title js-name"><a href="{%$item.url|f_escape_xml%}" target="_blank" title="{%$item.title|f_escape_xml%}">{%$item.title|f_escape_xml%}</a></p>\n<div class="zhixinErrorBox js-fixBox hidden" data-lemma-id="{%$item.lemmaId|f_escape_xml%}">\n<a class="submit-trigger" href="javascript:;">有错误</a>\n<span class="js-text hidden">已反馈</span>\n</div>\n</div>\n{%/foreach%}\n</div>\n</div>\n{%/foreach%}');a.exports=function(e,i){function a(){var e=t("#zhixinWrap"),a=t("#zhixinErrorForm"),s=a.find(".js-url"),l=a.find(".js-query"),m=a.find(".js-title"),r=a.find(".js-content"),o=a.find(".js-souceId");e.on("click",".js-fixBtn",function(){var e=t(this);e.toggleClass("show"),e.parent(".js-group").find(".js-fixBox").toggleClass("hidden"),e.hasClass("show")&&n(10000104)}),e.on("click",".js-fixBox .submit-trigger",function(e){var n=t(e.currentTarget);n.addClass("hidden"),n.siblings(".js-text").removeClass("hidden"),s.val(location.href),l.val(i||null),m.val(t.trim(n.parents(".js-group").find(".js-cardTitle").text())),r.val(t.trim(n.parent(".js-fixBox").siblings(".js-name").text())),o.val(n.parent(".js-fixBox").data("lemmaId")),a=t("#zhixinErrorForm")[0].submit()});for(var d=[],c=0;c<e.find(".js-fixBox").length;c++){var f=e.find(".js-fixBox")[c];d.push(f.getAttribute("data-lemma-id"))}var p=d.toString();n(10000103,window.location.href,{source:e.attr("data-source"),newLemmaId:e.attr("data-newLemmaId"),displayList:p})}t.ajax({url:"/wikiui/api/zhixinmap",data:{lemmaId:e},dataType:"json",success:function(e){if(e&&e.length>0)if(1===e.length&&"相关企业"===e[0].tipTitle)t(".lemmaWgt-sideRecommend").remove();else{e=e.slice(0,3);for(var i=0,s=e.length;s>i&&3>i;i++)e[i].data=e[i].data.slice(0,9-3*i);var n=l.fetch({dataList:e,dataType:"async"});t("#zhixinWrap").attr("data-source",e[0].source||"").html(n),t(".lemmaWgt-sideRecommend").show(),a()}else t(".lemmaWgt-sideRecommend").remove()},error:function(){t(".lemmaWgt-sideRecommend").remove()}})}});